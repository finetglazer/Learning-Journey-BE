# Server Configuration
server.port=8080
spring.application.name=APIGatewayService

# Request Size Limits
spring.webflux.multipart.max-in-memory-size=10MB
spring.codec.max-in-memory-size=10MB

# Gateway Timeout Configuration
spring.cloud.gateway.httpclient.response-timeout=15000
spring.cloud.gateway.httpclient.connect-timeout=5000

# ======================================================
#  Route Configurations
# ======================================================

# User Service API Route
spring.cloud.gateway.routes[0].id=user-service-api
spring.cloud.gateway.routes[0].uri=http://localhost:8081
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/users/**

# --- START: Added OAuth2 Routes for User Service ---

# Route for initiating OAuth2 login (e.g., /oauth2/authorization/google)
spring.cloud.gateway.routes[1].id=user-service-oauth-initiate
spring.cloud.gateway.routes[1].uri=http://localhost:8081
spring.cloud.gateway.routes[1].predicates[0]=Path=/oauth2/**

# Route for the OAuth2 redirect callback from Google
spring.cloud.gateway.routes[2].id=user-service-oauth-callback
spring.cloud.gateway.routes[2].uri=http://localhost:8081
spring.cloud.gateway.routes[2].predicates[0]=Path=/login/oauth2/**

# --- END: Added OAuth2 Routes for User Service ---

# Scheduling Service API Route
spring.cloud.gateway.routes[3].id=scheduling-service-api
spring.cloud.gateway.routes[3].uri=http://localhost:8082
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/calendar/**


# Project Service API Route
spring.cloud.gateway.routes[4].id=project-service-api
spring.cloud.gateway.routes[4].uri=http://localhost:8086
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/pm/**
# Preserve request body for multipart file uploads
spring.cloud.gateway.routes[4].filters[0]=PreserveHostHeader

# Document Service API Route
spring.cloud.gateway.routes[5].id=document-service-api
spring.cloud.gateway.routes[5].uri=http://localhost:8087
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/document/**

# Forum Service API Route
spring.cloud.gateway.routes[6].id=forum-service-api
spring.cloud.gateway.routes[6].uri=http://localhost:8088
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/forum/**

# Notification Service API Route
spring.cloud.gateway.routes[7].id=notification-service-api
spring.cloud.gateway.routes[7].uri=http://localhost:8089
spring.cloud.gateway.routes[7].predicates[0]=Path=/api/notification/**
# ======================================================
#  Global CORS Configuration
# ======================================================
spring.cloud.gateway.globalcors.corsConfigurations[/**].allowedOrigins=http://localhost:3000,http://localhost:3001,https://tttn-mkir-git-main-hungs-projects-c1b5e326.vercel.app
spring.cloud.gateway.globalcors.corsConfigurations[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS,PATCH
spring.cloud.gateway.globalcors.corsConfigurations[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations[/**].allowCredentials=true


# ======================================================
#  Actuator & Logging
# ======================================================
management.endpoints.web.exposure.include=health,info,gateway
management.endpoint.health.show-details=always
management.health.circuitbreakers.enabled=true

logging.level.org.springframework.cloud.gateway=INFO
logging.level.com.payment.apigatewayservice=INFO
logging.level.root=INFO


# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.access-token-expiration=900000
jwt.refresh-token-expiration=604800000

# Redis Configuration
spring.data.redis.url=${REDIS_URL}
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0

# Public endpoints (no JWT required)
app.public-endpoints=/api/users/auth/login,/api/users/auth/register,/api/users/auth/verify,/api/users/auth/forgot-password,/api/users/auth/reset-password,/api/users/auth/refresh,/actuator/**,/oauth2/**,/api/pm/projects/*/members/accept,/api/pm/projects/*/members/decline